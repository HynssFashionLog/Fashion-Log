<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Daily Look Post Detail</title>
  <!-- 임시 스크립트 -->
  <script>
    function toggleEditForm(commentId) {
      var viewSpan = document.getElementById('view-' + commentId);
      var editForm = document.getElementById('edit-' + commentId);
      var editButton = document.getElementById('edit-button-' + commentId);

      if (editForm.style.display === 'none') {
        viewSpan.style.display = 'none';
        editForm.style.display = 'inline';
        editButton.textContent = '취소';
      } else {
        viewSpan.style.display = 'inline';
        editForm.style.display = 'none';
        editButton.textContent = '수정';
      }
    }
  </script>
</head>
<body>
<h1>Daily Look Post</h1>
<div>
  <h2 th:text="${dailyLook.title}">Title</h2>
  <p>Content: <span th:text="${dailyLook.content}">Content</span></p>
  <a href="/fashionlog/dailylook">뒤로</a>
  <a th:href="@{/fashionlog/dailylook/{id}/edit(id=${dailyLook.id})}" class="edit-btn">수정</a>
  <form th:action="@{/fashionlog/dailylook/{id}/delete(id=${dailyLook.id})}" method="post">
    <button type="submit" class="delete-btn">삭제</button>
  </form>
</div>
<!-- 댓글 목록 -->
<table>
  <tbody>
  <tr th:each="comment:${dailyLookComments}">
    <td>작성자</td>
    <td>
      <!-- 일반 모드 -->
      <span th:id="'view-' + ${comment.id}" th:text="${comment.content}"></span>
      <!-- 수정 모드 -->
      <form th:id="'edit-' + ${comment.id}" style="display: none;"
            th:action="@{/fashionlog/dailylook/{postid}/edit-comment/{commentid}(postid=${dailyLook.id}, commentid=${comment.id})}"
            method="post">
        <input type="text" name="content" th:value="${comment.content}">
        <button type="submit">저장</button>
      </form>
    </td>
    <td th:if="${comment.updatedAt != null}" th:text="${comment.updatedAt}">작성일</td>
    <td th:unless="${comment.updatedAt != null}" th:text="${comment.createdAt}">작성일</td>
    <td>
      <!-- 수정 버튼 -->
      <button th:id="'edit-button-' + ${comment.id}" th:onclick="'toggleEditForm(' + ${comment.id} + ')'">수정</button>
    </td>
    <td>
      <!-- 삭제 버튼 -->
      <form th:action="@{/fashionlog/dailylook/{postid}/delete-comment/{commentid}(postid=${dailyLook.id}, commentid=${comment.id})}" method="post">
        <button type="submit">삭제</button>
      </form>
    </td>
  </tr>
  </tbody>
</table>
<!-- 댓글 작성 -->
<form th:action="@{/fashionlog/dailylook/{id}/comment(id=${dailyLook.id})}" th:object="${dailyLookComment}" method="post">
  <label for="content">댓글</label>
  <textarea id="content" name="content" th:field="*{content}"></textarea>
  <button type="submit">등록</button>
</form>
</body>
</html>